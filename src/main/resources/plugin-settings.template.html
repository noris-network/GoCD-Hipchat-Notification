<!--
  ~ Copyright 2016 ThoughtWorks, Inc.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--
This page contains the view for your settings.
Ensure that the keys you use are also declared in the GetPluginConfigurationExecutor class
-->
<h3>General Configuration</h3>
<div class="form_item_block">
  <label>Server URL:</label>
  <input type="text" ng-model="hipchat_server_url"/>
  <span class="form_error" ng-show="GOINPUTNAME[hipchat_server_url].$error.server">{{ GOINPUTNAME[hipchat_server_url].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>HipChat API key:</label>
  <input type="text" ng-model="hipchat_token"/>
  <span class="form_error" ng-show="GOINPUTNAME[hipchat_token].$error.server">{{ GOINPUTNAME[hipchat_token].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Room to notify:</label>
  <input type="text" ng-model="hipchat_room"/>
  <span class="form_error" ng-show="GOINPUTNAME[hipchat_room].$error.server">{{ GOINPUTNAME[hipchat_room].$error.server }}</span>
</div>
<!-- we do not have any information about stages, so I commented this option -->
<!--
<div class="form_item_block">
  <label>Notify for each stage individually:</label>
  <select ng-model="notify_per_stage" ng-required="true">
    <option value="true" selected="selected">True</option>
    <option value="false">False</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[notify_per_stage].$error.server">{{ GOINPUTNAME[notify_per_stage].$error.server }}</span>
</div>
-->

<hr />
<h3>Notifications for pipeline start</h3>
<div class="form_item_block">
  <label>Notify on pipeline start:</label>
  <select ng-model="notify_start" ng-required="true">
    <option value="true" selected="selected">True</option>
    <option value="false">False</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[notify_start].$error.server">{{ GOINPUTNAME[notify_start].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Job start message:</label>
  <label>Environment variables accessible with $ notation</label>
  <input type="text" ng-model="message_start"/>
  <span class="form_error" ng-show="GOINPUTNAME[message_start].$error.server">{{ GOINPUTNAME[message_start].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Color for job start message:<span class="asterisk">*</span></label>
  <select ng-model="color_start" ng-required="true">
    <option value="yellow" selected="selected">Yellow</option>
    <option value="green">Green</option>
    <option value="red">Red</option>
    <option value="purple">Purple</option>
    <option value="gray">Gray</option>
    <option value="random">Random</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[color_start].$error.server">{{ GOINPUTNAME[color_start].$error.server }}</span>
</div>

<hr />
<h3>Notifications for pipeline success</h3>
<div class="form_item_block">
  <label>Notify on success:</label>
  <select ng-model="notify_success" ng-required="true">
    <option value="true" selected="selected">True</option>
    <option value="false">False</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[notify_success].$error.server">{{ GOINPUTNAME[notify_success].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Success message:</label>
  <label>Environment variables accessible with $ notation</label>
  <input type="text" ng-model="message_success"/>
  <span class="form_error" ng-show="GOINPUTNAME[message_success].$error.server">{{ GOINPUTNAME[message_success].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Color for success message:<span class="asterisk">*</span></label>
  <select ng-model="color_success" ng-required="true">
    <option value="yellow">Yellow</option>
    <option value="green" selected="selected">Green</option>
    <option value="red">Red</option>
    <option value="purple">Purple</option>
    <option value="gray">Gray</option>
    <option value="random">Random</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[color_success].$error.server">{{ GOINPUTNAME[color_success].$error.server }}</span>
</div>

<hr />
<h3>Notifications for pipeline failure</h3>
<div class="form_item_block">
  <label>Notify on failure:</label>
  <select ng-model="notify_failure" ng-required="true">
    <option value="true" selected="selected">True</option>
    <option value="false">False</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[notify_failure].$error.server">{{ GOINPUTNAME[notify_failure].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Failure message:</label>
  <label>Environment variables accessible with $ notation</label>
  <input type="text" ng-model="message_failure"/>
  <span class="form_error" ng-show="GOINPUTNAME[message_failure].$error.server">{{ GOINPUTNAME[message_failure].$error.server }}</span>
</div>
<div class="form_item_block">
  <label>Color for failure message:<span class="asterisk">*</span></label>
  <select ng-model="color_failure" ng-required="true">
    <option value="yellow">Yellow</option>
    <option value="green">Green</option>
    <option value="red" selected="selected">Red</option>
    <option value="purple">Purple</option>
    <option value="gray">Gray</option>
    <option value="random">Random</option>
  </select>
  <span class="form_error" ng-show="GOINPUTNAME[color_failure].$error.server">{{ GOINPUTNAME[color_failure].$error.server }}</span>
</div>

<div class="help">
<hr />
<h3>Help</h3>
Message templates can be parametrized by using variables like ${this}. <br/>
The following variables are currently understood: <br/>

  <label>pipeline.name</label>
  <label>pipeline.counter</label>
  <label>pipeline.group</label>
  <label>pipeline.stage.name</label>
  <label>pipeline.stage.counter</label>
  <label>pipeline.stage.state</label>
  <label>pipeline.stage.result</label>

</div>
